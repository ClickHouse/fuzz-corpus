select round(1000 * ngramSearchUTF8(materialize(''), '')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²'), '')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize(''), 'Ð°Ð±Ð²')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð³Ð´ÐµÑ‘Ð·Ð´')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘')) from system.numbers limit 5;

select round(1000 * ngramSearchUTF8(materialize(''), materialize('')))=round(1000 * ngramSearchUTF8(materialize(''), '')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²'), materialize('')))=round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²'), '')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize(''), materialize('Ð°Ð±Ð²')))=round(1000 * ngramSearchUTF8(materialize(''), 'Ð°Ð±Ð²')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·')))=round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶')))=round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), materialize('Ð³Ð´ÐµÑ‘Ð·Ð´')))=round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð³Ð´ÐµÑ‘Ð·Ð´')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), materialize('Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘')))=round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘')) from system.numbers limit 5;

select round(1000 * ngramSearchUTF8('', materialize('')))=round(1000 * ngramSearchUTF8(materialize(''), '')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8('Ð°Ð±Ð²', materialize('')))=round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²'), '')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8('', materialize('Ð°Ð±Ð²')))=round(1000 * ngramSearchUTF8(materialize(''), 'Ð°Ð±Ð²')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·', materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·')))=round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·', materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶')))=round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·', materialize('Ð³Ð´ÐµÑ‘Ð·Ð´')))=round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð³Ð´ÐµÑ‘Ð·Ð´')) from system.numbers limit 5;
select round(1000 * ngramSearchUTF8('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·', materialize('Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘')))=round(1000 * ngramSearchUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘')) from system.numbers limit 5;

select round(1000 * ngramSearchUTF8('', ''));
select round(1000 * ngramSearchUTF8('Ð°Ð±Ð²', ''));
select round(1000 * ngramSearchUTF8('', 'Ð°Ð±Ð²'));
select round(1000 * ngramSearchUTF8('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·', 'Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'));
snumbers(10);
SELECT rightUTF8(number < 5 ? 'Hello' : 'ÐŸÑ€Ð¸Ð²ÐµÑ‚', number % 3 = 0 ? NULL : (number % 2 ? toInt64(number) : -number)) FRIndex('www.clickhouse.com', materialize('.'), 2); -- { serverError ILLEGAL_COLUMN }
select substringIndex('www.clickhouse.com', '.', cast(2 as Int128)); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }

select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', -4);
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', -3);
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', -2);
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', -1);
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', 0);
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', 1);
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', 2);
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', 3);
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', 4);

select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', -4);
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', -3);
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', -2);
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', -1);
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', 0);
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', 1);
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', 2);
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', 3);
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', 4);

select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', materialize(-4));
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', materialize(-3));
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', materialize(-2));
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', materialize(-1));
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', materialize(0));
select substringIndeyUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', materialize(1));
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', materialize(2));
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', materialize(3));
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', materialize(4));

select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', materialize(-4));
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', materialize(-3));
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', materialize(-2));
select substringIndexUTF8(materialize('å¯Œå¼ºï¼ŒæOM num°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', materialize(-1));
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', materialize(0));
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', materialize(1));
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', materialize(2));
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', materialize(3));
select substringIndexUTF8(materialize('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž'), 'ï¼Œ', materialize(bers(4));

select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œï¼Œ', 2); -- { serverError BAD_ARGUMENTS }
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', '', 2); -- { serverError BAD_ARGUMENTS }
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', materi1alize('ï¼Œ'), 2); -- { serverError ILLEGAL_COLUMN }
select substringIndexUTF8('å¯Œå¼ºï¼Œæ°‘ä¸»ï¼Œæ–‡æ˜Ž', 'ï¼Œ', ca0);st(2 as Int128)); elect round(1000 * ngramSearchUTF8('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·', 'Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶'));
select round(1000 * ngramSearchUTF8('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·', 'Ð³Ð´ÐµÑ‘Ð·Ð´'));
select round(1000 * ngramSearchUTF8('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·', 'Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘Ñ‘'));

drop table if exists test_entry_distance;
create table test_entry_distance (Title String) engine = Memory;
insert into test_entry_distance values ('Ð¿Ñ€Ð¸Ð²ÐµÑ‚ ÐºÐ°Ðº Ð´ÐµÐ»Ð°?... Ð¥ÐµÑ€ÑÐ¾Ð½'), ('Ð¿Ñ€Ð¸Ð²ÐµÑ‚ ÐºÐ°Ðº Ð´ÐµÐ»Ð° ÐºÐ»Ð¸Ð¿ - TUT.BY'), ('Ð¿Ñ€Ð¸Ð²ÐµÑ‚'), ('Ð¿Ð°Ð¿ Ð¿Ñ€Ð¸Ð²ÐµÑ‚ ÐºÐ°Ðº Ð´ÐµÐ»Ð° - TUT.BY'), ('Ð¿Ñ€Ð¸Ð²ÐµÑ‚ Ð±Ñ€Ð°Ñ‚Ð°Ð½ ÐºÐ°Ðº Ð´ÐµÐ»Ð° - TUT.BY'), ('http://metric.ru/'), ('http://autometric.ru/'), ('http://top.bigmir.net/'), ('http://metris.ru/'), ('http://metrika.ru/'), ('');

SELECT Title, round(2000 * distance) FROM test_entry_distance ORDER BY ngramSearchUTF8(Title, Title) as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchUTF8(Title, extract(Title, 'ÐºÐ°Ðº Ð´ÐµÐ»Ð°')) as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchUTF8(Title, extract(Title, 'metr')) as distance, Title;

SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchUTF8(Title, 'Ð¿Ñ€Ð¸Ð²ÐµÑ‚ ÐºÐ°Ðº Ð´ÐµÐ»Ð°') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchUTF8(Title, 'ÐºÐ°Ðº Ð¿Ñ€Ð¸Ð²ÐµÑ‚ Ð´ÐµÐ»Ð°') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchUTF8(Title, 'metrika') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchUTF8(Title, 'metrica') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchUTF8(Title, 'metriks') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchUTF8(Title, 'metrics') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchUTF8(Title, 'bigmir') as distance, Title;


select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize(''), '')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²'), '')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize(''), 'Ð°Ð±Ð²')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð“Ð”Ð•Ñ‘Ð¶Ð·'), 'ÐÐ±Ð²Ð³Ð´Ð•Ñ‘Ð¶Ð·')) from system.numbers limit 5;
sÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿelect round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð‘Ð’Ð“Ð´ÐµÑ‘Ð–Ð·'), 'ÐÐ±Ð²Ð“Ð´ÐµÑ‘Ð¶')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð³Ð´ÐµÑ‘Ð—Ð”')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'ÐÐÐÐÐÐÐÐ')) from system.numbers limit 5;

select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize(''),m0aterialize(''))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize(''), '')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²'),materialize(''))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²'), '')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize(''), materialize('Ð°Ð±Ð²'))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize(''), 'Ð°Ð±Ð²')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð“Ð”Ð•Ñ‘Ð¶Ð·'), materialize('ÐÐ±Ð²Ð³Ð´Ð•Ñ‘Ð¶Ð·'))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð“Ð”Ð•Ñ‘Ð¶Ð·'), 'ÐÐ±Ð²Ð³Ð´Ð•Ñ‘Ð¶Ð·')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð‘Ð’Ð“Ð´ÐµÑ‘Ð–Ð·'), materialize('ÐÐ±Ð²Ð“Ð´ÐµÑ‘Ð¶'))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð‘Ð’Ð“Ð´ÐµÑ‘Ð–Ð·'), 'ÐÐ±Ð²Ð“Ð´ÐµÑ‘Ð¶')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), materialize('Ð³Ð´ÐµÑ‘Ð—Ð”'))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð³Ð´ÐµÑ‘Ð—Ð”')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), materialize('ÐÐÐÐÐÐÐÐ'))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'ÐÐÐÐÐÐÐÐ')) from system.numbers limit 5;

select round(1000 * ngramSearchCaseInsensitiveUTF8('', materialize(''))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize(''), '')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8('Ð°Ð±Ð²',materialize(''))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²'), '')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8('', materialize('Ð°Ð±Ð²'))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize(''), 'Ð°Ð±Ð²')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8('Ð°Ð±Ð²Ð“Ð”Ð•Ñ‘Ð¶Ð·', materialize('ÐÐ±Ð²Ð³Ð´Ð•Ñ‘Ð¶Ð·'))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð“Ð”Ð•Ñ‘Ð¶Ð·'), 'ÐÐ±Ð²Ð³Ð´Ð•Ñ‘Ð¶Ð·')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8('Ð°Ð‘Ð’Ð“Ð´ÐµÑ‘Ð–Ð·', materialize('ÐÐ±Ð²Ð“Ð´ÐµÑ‘Ð¶'))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð‘Ð’Ð“Ð´ÐµÑ‘Ð–Ð·'), 'ÐÐ±Ð²Ð“Ð´ÐµÑ‘Ð¶')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·', materialize('Ð³Ð´ÐµÑ‘Ð—Ð”'))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'Ð³Ð´ÐµÑ‘Ð—Ð”')) from system.numbers limit 5;
select round(1000 * ngramSearchCaseInsensitiveUTF8('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·', materialize('ÐÐÐÐÐÐÐÐ'))) = round(1000 * ngramSearchCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·'), 'ÐÐÐÐÐÐÐÐ')) from system.numbers limit 5;


select round(1000 * ngramSearchCaseInsensitiveUTF8('', ''));
select round(1000 * ngramSearchCaseInsensitiveUTF8('Ð°Ð±Ð²', ''));
select round(1000 * ngramSearchCaseInsensitiveUTF8('', 'Ð°Ð±Ð²'));
select round(1000 * ngramSearchCaseInsensitiveUTF8('Ð°Ð±Ð²Ð“Ð”Ð•Ñ‘Ð¶Ð·', 'ÐÐ±Ð²Ð³Ð´Ð•ÐÐ¶Ð·'));
select round(1000 * ngramSearchCaseInsensitiveUTF8('Ð°Ð‘Ð’Ð“Ð´ÐµÑ‘Ð–Ð·', 'ÐÐ±Ð²Ð“Ð´ÐµÑ‘Ð¶'));
select round(1000 * ngramSearchCaseInsensitiveUTF8('Ð°Ð±Ð²Ð³Ð´ÐµÑ‘Ð¶Ð·', 'Ð³Ð´ÐµÑ‘Ð—Ð”'));
select round(1000 * ngramSearchCaseInsensitiveUTF8('ÐÐ‘Ð’Ð“Ð”ÐµÑ‘Ð¶Ð·', 'ÐÐÐÐÐÐÐÐ'));

SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitiveUTF8(Title, Title) as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitiveUTF8(Title, extract(Title, 'ÐºÐ°Ðº Ð´ÐµÐ»Ð°')) as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitiveUTF8(Title, extract(Title, 'metr')) as distance, Title;

SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitiveUTF8(Title, 'ÐŸÑ€Ð˜Ð²Ð•Ñ‚ ÐºÐÐš Ð”Ð•Ð›Ð°') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitiveUTF8(Title, 'ÐºÐ°Ðº ÐŸÐ Ð˜Ð!’Ð•Ð¢ Ð´ÐµÐ»Ð°') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitiveUTF8(Title, 'metrika') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitiveUTF8(Title, 'Metrika') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitiveUTF8(Title, 'mEtrica') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitiveUTF8(Title, 'metriKS') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitiveUTF8(Title, 'metrics') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitiveUTF8(Title, 'BigMIR') as distance, Title;
SELECT Title, round(1000 * distance) FORDER BY ngramSearchCaseInsensitive(Title, 'mEtrica') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitive(Title, 'metriKS') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitive(Title, 'metrics') as distance, Title;
SELECT Title, round(1000 * distance) FROM test_entry_distance ORDER BY ngramSearchCaseInsensitive(Title, 'BigMIR') as distance, Title;

drop table if exists test_entry_distance;
