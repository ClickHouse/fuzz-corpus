SET send_logs_level = 'fatal';

select 1 = position('', '');
select 1 = position('abc', '');
select 0 = position('', 'abc');
select 1 = position('abc', 'abc');
select 2 = position('abc', 'bc');
select 3 = position('abc', 'c');

select 1 = position('', '', 0);
select 1 = position('', '', 1);
select 0 = position('', '', 2);
select 1 = position('a', '', 1);
select 2 = position('a', '', 2);
select 0 = position('a', '', 3);

select [1, 1, 2, 3, 4, 5, 0, 0, 0, 0] = groupArray(position('aaaa', '', number)) from numbers(10);
select [1, 1, 2, 3, 4, 5, 0, 0, 0, 0] = groupArray(position(materialize('aaaa'), '', number)) from numbers(10);
select [1, 1, 2, 3, 4, 5, 0, 0, 0, 0] = groupArray(position('aaaa', materialize(''), number)) from numbers(10);
select [1, 1, 2, 3, 4, 5, 0, 0, 0, 0] = groupArray(position(materialize('aaaa'), materialize(''), number)) from numbers(10);

select [1, 1, 2, 3, 4, 0, 0, 0, 0, 0] = groupArray(position('aaaa', 'a', number)) from numbers(10);
select [1, 1, 2, 3, 4, 0, 0, 0, 0, 0] = groupArray(position(materialize('aaaa'), 'a', number)) from numbers(10);
select [1, 1, 2, 3, 4, 0, 0, 0, 0, 0] = groupArray(position('aaaa', materialize('a'), number)) from numbers(10);
select [1, 1, 2, 3, 4, 0, 0, 0, 0, 0] = groupArray(position(materialize('aaaa'), materialize('a'), number)) from numbers(10);

select 1 = position(materialize(''), '');
select 1 = position(materialize('abc'), '');
select 0 = position(materialize(''), 'abc');
select 1 = position(materialize('abc'), 'abc');
select 2 = position(materialize('abc'), 'bc');
select 3 = position(materialize('abc'), 'c');

select 1 = position(materialize(''), '') from system.numbers limit 10;
select 1 = position(materialize('abc'), '') from system.numbers limit 10;
select 0 = position(materialize(''), 'abc') from system.numbers limit 10;
select 1 = position(materialize('abc'), 'abc') from system.numbers limit 10;
select 2 = position(materialize('abc'), 'bc') from system.numbers limit 10;
select 3 = position(materialize('abc'), 'c') from system.numbers limit 10;

select 1 = position('', '');
select 1 = position('Ð°Ð±Ð²', '');
select 0 = position('', 'Ð°Ð±Ð²');
select 1 = position('Ð°Ð±Ð²', 'Ð°Ð±Ð²');
select 3 = position('Ð°Ð±Ð²', 'Ð±Ð²');
select 5 = position('Ð°Ð±Ð²', 'Ð²');

select 2 = position('abcabc', 'b', 0);
select 2 = position('abcabc', 'b', 1);
select 2 = position('abcabc', 'b', 2);
select 5 = position('abcabc', 'b', 3);
select 5 = position('abcabc', 'b', 4);
select 5 = position('abcabc', 'b', 5);
select 0 = position('abcabc', 'b', 6);
select 2 = position('abcabc', 'bca', 0);
select 0 = position('abcabc', 'bca', 3);

select 1 = position(materialize(''), '');
select 1 = position(materialize('Ð°Ð±Ð²'), '');
select 0 = position(materialize(''), 'Ð°Ð±Ð²');
select 1 = position(materialize('Ð°Ð±Ð²'), 'Ð°Ð±Ð²');
select 3 = position(materialize('Ð°Ð±Ð²'), 'Ð±Ð²');
select 5 = position(materialize('Ð°Ð±Ð²'), 'Ð²');

select 1 = position(materialize(''), '') from system.numbers limit 10;
select 1 = position(materialize('Ð°Ð±Ð²'), '') from system.numbers limit 10;
select 0 = position(materialize(''), 'Ð°Ð±Ð²') from system.numbers limit 10;
select 1 = position(materialize('Ð°Ð±Ð²'), 'Ð°Ð±Ð²') from system.numbers limit 10;
select 3 = position(materialize('Ð°Ð±Ð²'), 'Ð±Ð²') from system.numbers limit 10;
select 5 = position(materialize('Ð°Ð±Ð²'), 'Ð²') from system.numbers limit 10;

select 1 = positionUTF8('', '');
select 1 = positionUTF8('Ð°Ð±Ð²', '');
select 0 = positionUTF8('', 'Ð°Ð±Ð²');
select 1 = positionUTF8('Ð°Ð±Ð²', 'Ð°Ð±Ð²');
select 2 = positionUTF8('Ð°Ð±Ð²', 'Ð±Ð²');
select 3 = positionUTF8('Ð°Ð±Ð²', 'Ð²');

select 3 = position('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', 2);
select 3 = position('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', 3);
select 3 = position('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±Ð²Ð°', 2);
select 9 = position('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', 4);
select 0 = position('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±Ð²Ð°', 4);
select 5 = position('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð²', 0);
select 11 = position('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð²', 6);

select 1 = positionUTF8(materialize(''), '');
select 1 = positionUTF8(materialize('Ð°Ð±Ð²'), '');
select 0 = positionUTF8(materialize(''), 'Ð°Ð±Ð²');
select 1 = positionUTF8(materialize('Ð°Ð±Ð²'), 'Ð°Ð±Ð²');
select 2 = positionUTF8(materialize('Ð°Ð±Ð²'), 'Ð±Ð²');
select 3 = positionUTF8(materialize('Ð°Ð±Ð²'), 'Ð²');

select 1 = positionUTF8(materialize(''), '') from system.numbers limit 10;
select 1 = positionUTF8(materialize('Ð°Ð±Ð²'), '') from system.numbers limit 10;
select 0 = positionUTF8(materialize(''), 'Ð°Ð±Ð²') from system.numbers limit 10;
select 1 = positionUTF8(materialize('Ð°Ð±Ð²'), 'Ð°Ð±Ð²') from system.numbers limit 10;
select 2 = positionUTF8(materialize('Ð°Ð±Ð²'), 'Ð±Ð²') from system.numbers limit 10;
select 3 = positionUTF8(materialize('Ð°Ð±Ð²'), 'Ð²') from system.numbers limit 10;

select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', 0);
select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', 1);
select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', 2);
select 5 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', 3);
select 5 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', 4);
select 5 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', 5);
select 0 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', 6);
select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±Ð²Ð°', 0);
select 0 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±Ð²Ð°', 3);

select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', 0) from system.numbers limit 10;
select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', 1) from system.numbers limit 10;
select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', 2) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', 3) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', 4) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', 5) from system.numbers limit 10;
select 0 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', 6) from ÿÿÿÿÿÿumbers limit 10;
select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±Ð²Ð°', 0) from system.numbers limit 10;
select 0 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±Ð²Ð°', 3) from system.numbers limit 10;

select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 0) from system.numbers limit 10;
select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 1) fÞrom system.numbers limit 10;
select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 2) from sys±Ð²'), 'Ð±', 2) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', 3) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', 4) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', 5) from system.numbers limit 10;
select 0 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', 6) from system.numbers limit 10;
select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±Ð²Ð°', 0) from system.numbers limit 10;
select 0 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±Ð²Ð°', 3) from system.numbers limit 10;

select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 0) from system.numbers limit 10;
select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 1) from system.numbers limit 10;
select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 2) from system.numbers limit 10;
select 5 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 3) from system.numbers limit 10;
select 5 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 4) from system.numbers limit 10;
select 5 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 5) from system.numbers limit 10;
select 0 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 6) from system.numbers limit 10;
select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±Ð²Ð°'), 0) from system.numbers limit 10;
select 0 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±Ð²Ð°'), 3) from system.numbers limit 10;

select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 0) from system.numbers limit 10;
select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 1) from system.numbers limit 10;
select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 2) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 3) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 4) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 5) from system.numbers limit 10;
select 0 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 6) from system.numbers limit 10;
select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±Ð²Ð°'), 0) from system.numbers limit 10;
select 0 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±Ð²Ð°'), 3) from system.numbers limit 10;

select [2, 2, 2, 5, 5, 5, 0, 0, 0, 0] = groupArray(positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), number)) from numbers(10);
select [2, 2, 2, 5, 5, 5, 0, 0, 0, 0] = groupArray(positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), number)) from numbers(10);
select [2, 2, 2, 5, 5, 5, 0, 0, 0, 0] = groupArray(positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', number)) from numbers(10);
select [2, 2, 2, 5, 5, 5, 0, 0, 0, 0] = groupArray(positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', number)) from numbers(10);

select 1 = positionCaseInsensitive('', '');
select 1 = positionCaseInsensitive('abc', '');
select 0 = positionCaseInsensitive('', 'aBc');
select 1 = positionCaseInsensitive('abc', 'aBc');
select 2 = positionCaseInsensitive('abc', 'Bc');
select 3 = positionCaseInsensitive('abc', 'C');

select 1 = positionCaseInsensitive(materialize(''), '');
select 1 = positionCaseInsensitive(materialize('abc'), '');
select 0 = positionCaseInsensitive(materialize(''), 'aBc');
select 1 = positionCaseInsensitive(materialize('abc'), 'aBc');
select 2 = positionCaseInsensitive(materialize('abc'), 'Bc');
select 3 = positionCaseInsensitive(materialize('abc'), 'C');

select 1 = positionCaseInsensitive(materialize(''), '') from system.numbers limit 10;
select 1 = positionCaseInsensitive(materialize('abc'), '') from system.numbers limit 10;
select 0 = positionCaseInsensitive(materialize(''), 'aBc') from system.numbers limit 10;
select 1 = positionCaseInsensitive(materialize('abc'), 'aBc') from system.numbers limit 10;
select 2 = positionCaseInsensitive(materialize('abc'), 'Bc') from system.numbers limit 10;
select 3 = positionCaseInsensitive(materialize('abc'), 'C') from system.numbers limit 10;

select 6 = positionCaseInsensitiv¤(materialize('abcabc'), 'C', 4);
select 6 = positionCaseInsensitive(materialize('abcabc'), 'C', 4) from system.numbers limit 10;
select 6 = positionCaseInsensitive(materialize('abcabc'), 'C', materialize(4)) from system.numbers limit 10;

select 1 = positionCaseInsensitive('', '');
select 1 = positionCaseInsensitive('Ð°Ð±Ð²', '');
select 0 = positionCaseInsensitive('', 'Ð°Ð‘Ð²');
select 0 = positionCaseInsensitive('Ð°Ð±Ð²', 'Ð°Ð‘Ð²');
select 0 = positionCaseInsensitive('Ð°Ð±Ð²', 'Ð‘Ð²');
select 0 = positionCaseInsensitive('Ð°Ð±Ð²', 'Ð’');

select 1 = positionCaseInsensitive(materialize(''), '');
select 1 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), '');
select 0 = positionCaseInsensitive(materialize(''), 'Ð°Ð‘Ð²');
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð°Ð‘Ð²');
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð‘Ð²');
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð’');

select 1 = positionCaseInsensitive(materialize(''), '') from system.numbers limit 10;
select 1 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), '') from system.numbers limit 10;
select 0 = positionCaseInsensitive(materialize(''), 'Ð°Ð‘Ð²') from system.numbers limit 10;
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð°Ð‘Ð²') from system.numbers limit 10;
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð‘Ð²') from system.numbers limit 10;
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð’') from system.numbers limit 10;

select 1 = positionCaseInsensitiveUTF8('', '');
select 1 = positionCaseInsensitiveUTF8('Ð°Ð±Ð²', '');
select 0 = positionCaseInsensitiveUTF8('', 'Ð°Ð‘Ð²');
select 1 = positionCaseInsensitiveUTF8('Ð°Ð±Ð²', 'Ð°Ð‘Ð²');
select 2 = positionCaseInsensitiveUTF8('Ð°Ð±Ð²', 'Ð‘Ð²');
select 3 = positionCaseInsensitiveUTF8('Ð°Ð±Ð²', 'Ð²');

select 1 = positionCaseInsensitiveUTF8(materialize(''), '');
select 1 = positionCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²'), '');
select 0 = positionCaseInsensitiveUTF8(materialize(''), 'Ð°Ð‘Ð²');
select 1 = positionCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²'), 'Ð°Ðem.numbers limit 10;

select 1 = position('abcdefgh', materialize('abcdefgh')) from system.numbers limit 10;
select 1 = position('abcdefgh', materialize('abcdefg')) from system.numbers limit 10;
select 1 = position('abcdefgh', materialize('abcdef')) from system.numbers limit 10;
select 1 = position('abcdefgh', materialize('abcde')) from system.numbers limit 10;
select 1 = position('abcdefgh', materialize('abcd')) from system.numbers limit 10;
select 1 = position('abcdefgh', materialize('abc')) from system.numbers limit 10;
select 1 = position('abcdefgh', materialize('ab')) from system.numbers limit 10;
select 1 = position('abcdefgh', materialize('a')) from system.numbers limit 10;

select 3 = position('abcdefgh', materialize('c')) from system.numbers limit 10;
select 3 = position('abcdefgh', materialize('cd')) from system.numbers limit 10;
select 3 = position('abcdefgh', materialize('cde')) from system.numbers limit 10;
select 3 = position('abcdefgh', materialize('cdef')) from system.numbers limit 10;
select 3 = position('abcdefgh', materialize('cdefg')) from system.numbers limit 10;
select 3 = position('abcdefgh', materialize('cdefgh')) from system.numbers limit 10;

select 4 = position('abcdefgh', materialize('defgh')) from system.numbers limit 10;
select 4 = position('abcdefgh', materialize('defg')) from system.numbers limit 10;
select 4 = position('abcdefgh', materialize('def')) from system.numbers limit 10;
select 4 = position('abcdefgh', materialize('de')) from system.numbers limit 10;
select 4 = position('abcdefgh', materialize('d')) from system.numbers limit 10;

select 5 = position('abcdefgh', materialize('e')) from system.numbers limit 10;
select 5 = position('abcdefgh', materialize('ef')) from system.numbers limit 10;
select 5 = position('abcdefgh', materialize('efg')) from system.numbers limit 10;
select 5 = position('abcdefgh', materialize('efgh')) from system.numbers limit 10;

select 6 = position('abcdefgh', materialize('fgh')) from system.numbers limit 10;
select 6 = position('abcdefgh', materialize('fg')) from system.numbers limit 10;
select 6 = position('abcdefgh', materialize('f')) from system.numbers limit 10;

select 7 = position('abcdefgh', materialize('g')) from system.numbers limit 10;
select 7 = position('abcdefgh', materialize('gh')) from system.numbers limit 10;

select 8 = position('abcdefgh', materialize('h')) from system.numbers limit 10;

select 2 = position('abcdefgh', materialize('b')) from system.numbers limit 129;
select 2 = position('abcdefgh', materialize('bc')) from system.numbers limit 129;
select 2 = position('abcdefgh', materialize('bcd')) from system.numbers limit 10;
select 2 = position('abcdefgh', materialize('bcde')) from system.numbers limit 129;
select 2 = position('abcdefgh', materialize('bcdef')) from system.numbers limit 129;
select 2 = position('abcdefgh', materialize('bcdefg')) from system.numbers limit 129;
select 2 = position('abcdefgh', materialize('bcdefgh')) from system.numbers limit 129;

select 1 = position('abcdefgh', materialize('abcdefgh')) from system.alize(''), 'Ð°Ð‘Ð²') from system.numbers limit 10;
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð°Ð‘Ð²') from system.numbers limit 10;
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð‘Ð²') from system.numbers limit 10;
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð’') from system.numbers limit 10;

select 1 = positionCaseInsensitiveUTF8('', '');
select 1 = positionCaseInsensitiveUTF8('Ð°Ð±Ð²', '');
select 0 = positionCaseInsensitiveUTF8('', 'Ð°Ð‘Ð²');
select 1 = positionCaseInsensitiveUTF8('Ð°Ð±Ð²', 'Ð°Ð‘Ð²');
select 2 = positionCaseInsensitiveUTF8('Ð°Ð±Ð²', 'Ð‘Ð²');
select 3 = positionCaseInsensitiveUTF8('Ð°Ð±Ð²', 'Ð²');

select 1 = positionCaseInsensitiveUTF8(materialize(''), '');
select 1 = positionCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²'), '');
select 0 = positionCaseInsensitiveUTF8(materialize(''), 'Ð°Ð‘Ð²');
select 1 = positionCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²'), 'Ð°Ð‘Ð²');
select 2 = positionCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²'), 'Ð‘Ð²');
select 3 = positionCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²'), 'Ð’');

select 1 = positionCaseInsensitiveUTF8(materialize(''), '') from system.numbers limit 10;
select 1 = positionCaseInsensitiveUTF8(materialize('Ð°Ð±Ð²'), 'tem.numbers limit 10;
select 5 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 3) from system.numbers limit 10;
select 5 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 4) from system.numbers limit 10;
select 5 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 5) from system.numbers limit 10;
select 0 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), 6) from system.numbers limit 10;
select 2 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±Ð²Ð°'), 0) from system.numbers limit 10;
select 0 = positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±Ð²Ð°'), 3) from system.numbers limit 10;

select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 0) from system.numbers limit 10;
select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 1) from system.numbers limit 10;
select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 2) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 3) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 4) from system.numbers limit 10;
select 5 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 5) from system.numbers limit 10;
select 0 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), 6) from system.numbers limit 10;
select 2 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±Ð²Ð°'), 0) from system.numbers limit 10;
select 0 = positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±Ð²Ð°'), 3) from system.numbers limit 10;

select [2, 2, 2, 5, 5, 5, 0, 0, 0, 0] = groupArray(positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), materialize('Ð±'), number)) from numbers(10);
select [2, 2, 2, 5, 5, 5, 0, 0, 0, 0] = groupArray(positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', materialize('Ð±'), number)) from numbers(10);
select [2, 2, 2, 5, 5, 5, 0, 0, 0, 0] = groupArray(positionUTF8('Ð°Ð±Ð²Ð°Ð±Ð²', 'Ð±', number)) from numbers(10);
select [2, 2, 2, 5, 5, 5, 0, 0, 0, 0] = groupArray(positionUTF8(materialize('Ð°Ð±Ð²Ð°Ð±Ð²'), 'Ð±', number)) from numbers(10);

select 1 = positionCaseInsensitive('', '');
select 1 = positionCaseInsensitive('abc', '');
select 0 = positionCaseInsensitive('', 'aBc');
select 1 = positionCaseInsensitive('abc', 'aBc');
select 2 = positionCaseInsensitive('abc', 'Bc');
select 3 = positionCaseInsensitive('abc', 'C');

select 1 = positionCaseInsensitive(materialize(''), '');
select 1 = positionCaseInsensitive(materialize('abc'), '');
select 0 = positionCaseInsensitive(materialize(''), 'aBc');
select 1 = positionCaseInsensitive(materialize('abc'), 'aBc');
select 2 = positionCaseInsensitive(materialize('abc'), 'Bc');
select 3 = positionCaseInsensitive(materialize('abc'), 'C');

select 1 = positionCaseInsensitive(materialize(''), '') from system.numbers limit 10;
select 1 = positionCaseInsensitive(materialize('abc'), '') from system.numbers limit 10;
select 0 = positionCaseInsensitive(materialize(''), 'aBc') from system.numbers limit 10;
select 1 = positionCaseInsensitive(materialize('abc'), 'aBc') from system.numbers limit 10;
select 2 = positionCaseInsensitive(materialize('abc'), 'Bc') from system.numbers limit 10;
select 3 = positionCaseInsensitive(materialize('abc'), 'C') from system.numbers limit 10;

select 6 = positionCaseInsensitiv¤(materialize('abcabc'), 'C', 4);
select 6 = positionCaseInsensitive(materialize('abcabc'), 'C', 4) from system.numbers limit 10;
select 6 = positionCaseInsensitive(materialize('abcabc'), 'C', materialize(4)) from system.numbers limit 10;

select 1 = positionCaseInsensitive('', '');
select 1 = positionCaseInsensitive('Ð°Ð±Ð²', '');
select 0 = positionCaseInsensitive('', 'Ð°Ð‘Ð²');
select 0 = positionCaseInsensitive('Ð°Ð±Ð²', 'Ð°Ð‘Ð²');
select 0 = positionCaseInsensitive('Ð°Ð±Ð²', 'Ð‘Ð²');
select 0 = positionCaseInsensitive('Ð°Ð±Ð²', 'Ð’');

select 1 = positionCaseInsensitive(materialize(''), '');
select 1 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), '');
select 0 = positionCaseInsensitive(materialize(''), 'Ð°Ð‘Ð²');
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð°Ð‘Ð²');
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð‘Ð²');
select 0 = positionCaseInsensitive(materialize('Ð°Ð±Ð²'), 'Ð’');

select 1 = positionCaseInsensitive(materialize(''), '') from system.numbers limit 10;
select 1 = positionCaseInsensitivec', materialize('')) from system.numbers limit 100;
select 1 = position('abc', materialize('')) from system.numbers limit 1000;

select 1 = position('abab', materialize('ab'));
select 1 = position('abababababababababababab', materialize('abab'));
select 1 = position('abababababababababababab', materialize('abababababababababa'));
