SELECT positionCaseInsensitiveUTF8(concat('Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat(' Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('  Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('   Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('    Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('     Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('      Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('       Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('        Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('         Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('          Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('           Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('            Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('             Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('              Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('               Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('                Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('                 Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('                  Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('                   Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('                    Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('                     Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitiveUTF8(concat('                      Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;

SELECT positionCaseInsensitive(concat('Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat(' Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('  Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('   Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('    Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('     Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('      Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('       Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('        Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('         Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('          Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('           Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('            Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('             Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('              Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('               Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('                Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('                 Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('                  Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñ-- https://github.com/ClickHouse/ClickHouse/issues/35359

-- sumMap
SELECT x[67]
FROM
(
    SELECT
        A,
        sumMap(CAST(arrayMap(x -> (x, 1), r), 'Map(UInt8,Int64)')) AS x
    FROM remote('127.{1,1}', view(
        SELECT
            number AS A,
            range(150) AS r
        FROM numbers(60)
        WHERE (A % 2) = shardNum()
    ))
    GROUP BY A
    LIMIT 100000000
)
WHERE A = 53
SETTINGS prefer_localhost_replica = 0, distributed_aggregation_memory_efficient = 1, group_by_two_level_threshold = 0, group_by_two_level_threshold_bytes = 0;

-- minMap
SELECT x[0]
FROM
(
    SELECT
        A,
    ƒ') AS res;
SELECT positionCaseInsensitive(concat('                   Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('                    Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('                     Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionCaseInsensitive(concat('                      Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;

SELECT positionUTF8(concat('Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat(' Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('  Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('   Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('    Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('     Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('      Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('       Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('        Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('         Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('          Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('           Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('            Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('             Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('              Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('               Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('                Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('                 Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('                  Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('                   Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('                    Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('                     Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT positionUTF8(concat('                      Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;

SELECT position(concat('Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat(' Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('  Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('   Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('    Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('     Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('      Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('       Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('        Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('         Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('          Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('           Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('            Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('             Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('              Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arzayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('               Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('                Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('                 Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³    minMap(CAST(arrayMap(x -> (x, 1), r), 'Map(UInt8,Int64)')) AS x
    FROM remote('127.{1,1}', view(
        SELECT
            number AS A,
            raÐ¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('                  Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('                   Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('                    Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('                     Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;
SELECT position(concat('                      Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ', arrayStringConcat(arrayMap(x -> ' ', range(20000)))), 'Ð¸Ð³Ð¾Ð»ÐºÐ°.Ñ€Ñƒ') AS res;

SELECT positionCaseInsensitiveUTF8(materialize('test ÃŸ test'), 'ÃŸ') AS res;
SELECT positionCaseInsensitiveUTF8(materialize('test AaÃŸAa test'), 'aÃŸa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize('test A1ÃŸ2a test'), '1ÃŸ2') AS res;
SELECT positionCaseInsensitiveUTF8(materialize('xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest'), 'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;

SELECT positionCaseInsensitiveUTF8(materialize(concat('test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat(' test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('  test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('   test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('    test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('     test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('      test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('       test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('        test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('         test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('          test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('           test a1ÃŸAa test', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'a1áºžaa') AS res;

SELECT positionCaseInsensitiveUTF8(materialize(concat('xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat(' xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('  xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('   xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('    xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('     xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('      xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('       xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('        xáºžyyaa1áºž1yzáºžXáºnge(150) AS r
        FROM numbers(60)
        WHERE (A % 2) = shardNum()
    ))
    GROUP BY A
    LIMIT 100000000
)
WHERE A = 41
SETTINGS prefer_localhost_replica = 0, distributed_aggregation_memory_efficient = 1, group_by_two_level_threshold = 0, group_by_two_level_threshold_bytes = 0;

-- maxMap
SELECT x[0]
FROM
(
    SELECT
        A,
        maxMap(CAST(arrayMap(x -> (x, 1), r), 'Map(UInt8,Int64)')) AS x
    FROM remote('127.{1,1}', view(
        SELECT
            number AS A,
            range(150) AS r
        FROM numbers(60)
        WHERE (A % 2) = shardNum()
    ))
    GROUP BY A
    LIMIT 100000000
)
WHERE A = 41
SETTINGS prefer_localhost_replica = 0, distributed_aggregation_memory_efficient = 1, group_by_two_level_threshold = 0, group_by_two_level_threshold_bytes = 0;

-- avgMap
SELECT x[0]
FROM
(
    SELECT
        A,
        avgMap(CAST(arrayMap(x -> (x, 1), r), 'Map(UInt8,Int64)')) AS x
    FROM remote(žáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('         xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'aa1áºž1YzÃ'127.{1,1}', view(
        SELECT
            number AS A,
            range(150) AS r
        FROM numbers(60)
        WHERE (A % 2) = shardNum()
    ))
    GROUP BY A
    LIMIT 100000000
)
WHERE A = 41
SETTINGS prefer_localhost_replica = 0, distributed_aggregation_memory_efficient = 1, grŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;
SELECT positionCaoup_by_two_level_threshold = 0, gseInsensitiveUTF8(materializeroup_by_two_level_thr(concat('          xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(x -> ' ', range(20000))))), 'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC') AS res;
SELECT positionCaseInsensitiveUTF8(materialize(concat('           xáºžyyaa1áºž1yzáºžXáºžáºž1áºžáºž1bctest', arrayStringConcat(arrayMap(xeshol -> ' d_bytes = ', range(20000))))), 0;'aa1áºž1YzÃŸxÃŸÃŸ1ÃŸÃŸ1BC')
 AS res;
