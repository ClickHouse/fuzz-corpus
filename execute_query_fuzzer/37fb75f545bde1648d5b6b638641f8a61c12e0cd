SELECT
    sum(c),
    toInt32((h - null::Nullable(DateTime)) / 3600) + 1 AS a
FROM
(
    SELECT count() AS c, h
    FROM ( SELECT now() AS h )
    WHERE toInt32((h - null::Nul()), bin(nd(n2, ip1)), bin(bitApression = 0;
